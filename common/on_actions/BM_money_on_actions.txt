################ this is the core of the mod when all calculation and stock information is kept###############

on_actions = {
	on_startup = {
		effect = {
			every_country = {
				if = {
					limit = {
						NOT = { is_in_array = { global.GDP_list_array = THIS } }
					}
					add_to_array = { global.GDP_list_array = THIS }
				}
				calculate_GDP = no
				GDP_growth_calculation = yes
				gdp_growth_calc = yes
			}
			
		}
	}
    
    ## Economic System ##
    on_monthly = {
		effect = {
			calculate_GDP = yes
			GDP_growth_calculation = yes
			force_update_map_mode = { mapmode = TWR_government_type_map_mode }
			force_update_map_mode = { mapmode = TWR_industrialisation_map_mode }
		}
	}
    on_weekly = {
	
		effect = {
				clear_variable = resourceincome
				clear_variable = resourceexpenses
				clear_variable = allexpenses
				clear_variable = nmn

				set_variable = { nmn = 0}
				set_variable = { nmnw = 0}

				divide_variable = { var = nmn value = 10 }

				every_country={
					limit={
						is_puppet = yes
				}
				divide_variable ={var=overcome value= 2}
			  	set_variable = { tax_to_overlord = overcome}
				}
				

                ## Money Calc. ##

				set_variable = { cfff = num_of_civilian_factories}
				divide_variable = { var = cfff value = 15 }
				
				set_variable = { tax= num_of_controlled_states}
				divide_variable = { var = tax value = 15 }
				
				set_variable = { nc= num_of_controlled_states}
				divide_variable = { var = nc value = 175 }
				
				set_variable = { chromium_export = resource_exported@chromium}
				divide_variable = { var = chromium_export value = 200 }
				
				set_variable = { tungsten_export = resource_exported@tungsten}
				divide_variable = { var = tungsten_export value = 500 }
				
				set_variable = { rubber_export = resource_exported@rubber}
				divide_variable = { var = rubber_export value = 500 }
				
				set_variable = { aluminium_export = resource_exported@aluminium}
				divide_variable = { var = aluminium_export value = 500 }
				
				set_variable = { oil_export = resource_exported@oil}
				divide_variable = { var = oil_export value = 200 }
				
				set_variable = { steel_export = resource_exported@steel}
				divide_variable = { var = steel_export value = 500 }
				
				set_variable = { nf = num_of_military_factories}
				divide_variable = { var = nf value = 7 }
				
				set_variable = { navf = num_of_naval_factories}
				divide_variable = { var = navf value = 7 }
				
				set_variable = { ms = num_divisions}
				divide_variable = { var = ms value = 47 }
				
				set_variable = { chromium_import = resource_imported@chromium}
				divide_variable = { var = chromium_import value = 150 }
				
				set_variable = { tungsten_import = resource_imported@tungsten}
				divide_variable = { var = tungsten_import value = 300 }
				
				set_variable = { rubber_import = resource_imported@rubber}
				divide_variable = { var = rubber_import value = 300 }
				
				set_variable = { aluminium_import = resource_imported@aluminium}
				divide_variable = { var = aluminium_import value = 300 }
				
				set_variable = { oil_import = resource_imported@oil}
				divide_variable = { var = oil_import value = 150 }
				
				set_variable = { steel_import = resource_imported@steel}
				divide_variable = { var = steel_import value = 300 }

                set_variable = { debtexp = debttotal}
				
				divide_variable = { var = debtexp value = 3 }
				divide_variable = { var = debtexp value = 52 }

				set_variable ={	allexpenses = 0		 }
				set_variable ={	resourceexpenses = 0 }
				set_variable ={	resourceincome = 0   }

				add_to_variable = { var = resourceincome value = rubber_export}
				add_to_variable = { var = resourceincome value = chromium_export}
				add_to_variable = { var = resourceincome value = tungsten_export}
				add_to_variable = { var = resourceincome value = steel_export}
				add_to_variable = { var = resourceincome value = oil_export}
				add_to_variable = { var = resourceincome value = aluminium_export}
				
				add_to_variable = { var = resourceexpenses value = rubber_import}
				add_to_variable = { var = resourceexpenses value = chromium_import}
				add_to_variable = { var = resourceexpenses value = tungsten_import}
				add_to_variable = { var = resourceexpenses value = steel_import}
				add_to_variable = { var = resourceexpenses value = oil_import}
				add_to_variable = { var = resourceexpenses value = aluminium_import} 
				
				add_to_variable = { var = allexpenses value = nc}
				add_to_variable = { var = allexpenses value = rubber_import}
				add_to_variable = { var = allexpenses value = chromium_import}
				add_to_variable = { var = allexpenses value = tungsten_import}
				add_to_variable = { var = allexpenses value = steel_import}
				add_to_variable = { var = allexpenses value = oil_import}
				add_to_variable = { var = allexpenses value = aluminium_import}
				add_to_variable = { var = allexpenses value = ms}
				add_to_variable = { var = allexpenses value = nf}
				add_to_variable = { var = allexpenses value = navf}
				add_to_variable = { var = allexpenses value = debtexp}		

				add_to_variable = { var = nmn value = tax }
				add_to_variable = { var = nmn value = resourceincome }
				add_to_variable = { var = nmn value = cfff }

				add_to_variable = { var = nmnw value = tax }
				add_to_variable = { var = nmnw value = resourceincome }
				add_to_variable = { var = nmnw value = cfff }

				subtract_from_variable = { var = nmn value = allexpenses }
				
				set_variable = {overcome = nmn}
				
            	add_to_variable = { var = dx value = nmn  }

            	#round_variable = dx
		}
	}		
}
